import{m as F,r as d,w as M,j as e}from"./index-CWCk8Mfu.js";import{f as I}from"./api-helnlucg.js";import{C as B}from"./CRow-D5FXM-Wo.js";import{C as E}from"./CCol-DELpJvbl.js";import{C as k,a as H}from"./CCardBody-CjD5VXLl.js";import{C as V}from"./CCardHeader-DfyZxt5z.js";import{C as q}from"./CForm-CjIivhzA.js";import{C as h}from"./CFormLabel-C5kMTk4Z.js";import{C as x}from"./CFormInput-9pZ0Cm2L.js";import{a as L}from"./index.esm-CtJdof8l.js";import{C as O,a as z,b as m,c as o,d as G,e as l}from"./CTable-CUUuWsJ5.js";import{C as j}from"./DefaultLayout-CWVqZZSL.js";import"./cil-mobile-C0RpYdWd.js";const re=()=>{F();const[p,C]=d.useState([]),[f,v]=d.useState(0),[A,g]=d.useState(0),[S,b]=d.useState(0),[D,T]=d.useState(!1),{showToast:c}=M(),[i,_]=d.useState({start_date:"",end_date:""}),u=a=>{const{name:r,value:n}=a.target;_({...i,[r]:n})},y=async()=>{try{const a=await I("/api/reportSales?startDate="+i.start_date+"&endDate="+i.end_date);if(a){const r=a.reduce((t,s)=>(t[s.invoiceDate]||(t[s.invoiceDate]={invoiceDate:s.invoiceDate,totalAmount:0,paidAmount:0}),t[s.invoiceDate].totalAmount+=s.totalAmount,t[s.invoiceDate].paidAmount+=s.paidAmount,t),{}),n=Object.values(r).map(t=>({...t,totalAmount:Math.round(t.totalAmount),paidAmount:Math.round(t.paidAmount),remainingAmount:Math.round(t.totalAmount-t.paidAmount)}));C(n);const R=n.reduce((t,s)=>t+s.totalAmount,0),P=n.reduce((t,s)=>t+s.paidAmount,0),w=n.reduce((t,s)=>t+s.remainingAmount,0);v(Math.round(R)),g(Math.round(P)),b(Math.round(w))}else c("danger","Failed to fetch records")}catch(a){c("danger","Error occured "+a)}},N=async a=>{try{const r=a.currentTarget;a.preventDefault(),a.stopPropagation(),T(!0),r.checkValidity()&&await y()}catch(r){c("danger","Failed to fetch records"+r)}};return e.jsx(B,{children:e.jsx(E,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsx(V,{children:e.jsx("strong",{children:"Sales Report"})}),e.jsxs(H,{children:[e.jsx(q,{onSubmit:N,noValidate:!0,validated:D,children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(h,{htmlFor:"start_date",children:"Start Date"}),e.jsx(x,{type:"date",id:"start_date",name:"start_date",value:i.start_date,onChange:u,required:!0,feedbackInvalid:"Please select date."})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(h,{htmlFor:"end_date",children:"End Date"}),e.jsx(x,{type:"date",id:"end_date",name:"end_date",value:i.end_date,onChange:u,required:!0,feedbackInvalid:"Please select date."})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsx("div",{className:"mb-1 mt-4",children:e.jsx(L,{color:"success",type:"submit",children:"Submit"})})})]})}),e.jsx("hr",{}),e.jsx("div",{className:"table-responsive",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(m,{children:[e.jsx(o,{children:"Invoice Date"}),e.jsx(o,{children:"Total Amount"}),e.jsx(o,{children:"Paid Amount"}),e.jsx(o,{children:"Remaining Amount"})]})}),e.jsxs(G,{children:[p.map((a,r)=>e.jsxs(m,{children:[e.jsx(l,{children:a.invoiceDate}),e.jsx(l,{children:a.totalAmount}),e.jsx(l,{children:a.paidAmount}),e.jsx(l,{children:a.remainingAmount})]},r)),e.jsxs(m,{children:[e.jsx(o,{children:"Total"}),e.jsx(o,{children:f}),e.jsx(o,{children:e.jsx(j,{color:"success",children:A})}),e.jsx(o,{children:e.jsx(j,{color:"danger",children:S})})]})]})]})})]})]})})})};export{re as default};
