import{j as e,w as E,r as f}from"./index-CWCk8Mfu.js";import{a as j,h as M}from"./api-helnlucg.js";import{u as C}from"./DefaultLayout-CWVqZZSL.js";import{C as S,a as L,b as v,c as y,d as B}from"./CModalTitle-C4XdBZVB.js";import{a as x}from"./index.esm-CtJdof8l.js";import{C as w}from"./CForm-CjIivhzA.js";import{C as b}from"./CFormLabel-C5kMTk4Z.js";import{C as _}from"./CFormInput-9pZ0Cm2L.js";import{C as F}from"./CFormTextarea-C5z35aZe.js";function H({visible:c,setVisible:s}){var a;const o=j(),{t:i}=C("global"),t="img/"+((a=o==null?void 0:o.company_info)==null?void 0:a.paymentQRCode),m=async()=>{try{const l=await(await fetch(t)).blob(),d=new File([l],"QRCode.png",{type:"image/png"});navigator.canShare&&navigator.canShare({files:[d]})?await navigator.share({title:"Check out my QR code!",files:[d]}):alert("Your browser does not support sharing files.")}catch(r){console.error("Error sharing the image:",r)}};return e.jsx(e.Fragment,{children:e.jsxs(S,{backdrop:"static",visible:c,onClose:()=>s(!1),"aria-labelledby":"StaticBackdropExampleLabel",children:[e.jsx(L,{children:e.jsx(v,{id:"StaticBackdropExampleLabel",children:i("LABELS.qr")})}),e.jsx(y,{children:e.jsx("div",{className:"text-center",children:e.jsx("img",{style:{maxHeight:"350px"},className:"img-thumbnail img-fluid",src:t})})}),e.jsxs(B,{children:[e.jsx(x,{color:"success",onClick:m,children:i("LABELS.share")}),e.jsx(x,{color:"danger",onClick:()=>s(!1),children:i("LABELS.close")})]})]})})}function U({visible:c,hint:s,setVisible:o,onSuccess:i}){const t=j(),{showToast:m}=E(),{t:a}=C("global"),[r,l]=f.useState({name:s,mobile:"",discount:0,company_id:t==null?void 0:t.company_id,show:!0,address:""});f.useEffect(()=>{c&&(/^\d+$/.test(s==null?void 0:s.trim())?l({...r,mobile:s.trim()}):l({...r,name:s==null?void 0:s.trim()}))},[s,c]);const d=p=>{const{name:h,value:u}=p.target;l({...r,[h]:u})},k=async p=>{p.preventDefault();const h=p.target;if(!h.checkValidity()){h.classList.add("was-validated");return}let u={...r};u.discount||(u.discount=0);try{const n=await M("/api/customer",u);n!=null&&n.id?(m("success",a("MSG.data_saved_successfully_msg")),i(n),o(!1),g()):m("danger",a("MSG.failed_to_create"))}catch(n){m("danger","Error occured "+n)}},g=()=>{l({name:"",mobile:"",discount:0,company_id:r.company_id,show:!0,address:""})};return e.jsx(e.Fragment,{children:e.jsxs(S,{backdrop:"static",visible:c,onClose:()=>{g(),o(!1)},"aria-labelledby":"StaticBackdropExampleLabel",children:[e.jsx(L,{children:e.jsx(v,{id:"StaticBackdropExampleLabel",children:a("LABELS.new_customer")})}),e.jsx(y,{children:e.jsxs(w,{className:"needs-validation",noValidate:!0,onSubmit:k,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"pname",children:a("LABELS.customer_name")}),e.jsx(_,{type:"text",id:"pname",placeholder:a("MSG.enter_customer_name_msg"),name:"name",value:r.name,onChange:d,required:!0,feedbackInvalid:a("MSG.please_provide_name"),feedbackValid:a("MSG.looks_good_msg")}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.name_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"plmobile",children:a("LABELS.mobile_number")}),e.jsx(_,{type:"text",id:"plmobile",placeholder:a("MSG.enter_mob_no_msg"),name:"mobile",value:r.mobile,minLength:10,maxLength:10,onChange:d,required:!0,pattern:"\\d{10}",autoComplete:"off",feedbackInvalid:a("MSG.please_provide_mobile_number_msg"),feedbackValid:a("MSG.looks_good_msg")}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.mobile_number_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"address",children:a("LABELS.address")}),e.jsx(F,{id:"address",rows:2,name:"address",value:r.address,onChange:d})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{color:"success",type:"submit",children:a("LABELS.submit")}),"Â ",e.jsx(x,{color:"danger",onClick:()=>{g(),o(!1)},children:a("LABELS.close")})]})]})})]})})}export{U as N,H as Q};
