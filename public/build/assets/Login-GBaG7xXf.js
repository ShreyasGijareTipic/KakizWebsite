import{r as a,_ as R,a as S,b as T,c as E,P as g,m as G,w as H,j as e}from"./index-CWCk8Mfu.js";import{b as U,c as p,a as C}from"./index.esm-CtJdof8l.js";import{i as V,c as D,b as F,e as _,s as z}from"./api-helnlucg.js";import{C as y}from"./CRow-D5FXM-Wo.js";import{C as c}from"./CCol-DELpJvbl.js";import{C as q,a as A}from"./CCardBody-CjD5VXLl.js";import{C as B}from"./CForm-CjIivhzA.js";import{C as j,a as v}from"./CInputGroupText-Dgi-RtrH.js";import{C as b}from"./CFormInput-9pZ0Cm2L.js";import"./CFormLabel-C5kMTk4Z.js";var m=a.forwardRef(function(o,i){var l=o.children,n=o.className,t=R(o,["children","className"]);return S.createElement("div",T({className:E("card-group",n)},t,{ref:i}),l)});m.propTypes={children:g.node,className:g.string};m.displayName="CCardGroup";var Z=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M336,113.375H176v144H56V296L255.8,496,456,296.007V257.375H336Zm81.361,176L255.826,450.746,94.616,289.375H208v-144h96v144Z' class='ci-primary'/><rect width='400' height='32' x='56' y='17.376' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"];const M=""+new URL("samarthNursuryLogo-Cfrlb0l5.png",import.meta.url).href,$=""+new URL("nurseryPlant-DtzFiG_A.jpg",import.meta.url).href,ae=()=>{const[o,i]=a.useState(!1),[l,n]=a.useState(!1),t=G(),u=a.useRef(),f=a.useRef(),{showToast:d}=H();a.useEffect(()=>{V()&&t("/dashboard")},[]),window.addEventListener("beforeinstallprompt",r=>{r.preventDefault(),window.deferredPrompt=r,n(!0)});const N=async()=>{if(window.deferredPrompt){window.deferredPrompt.prompt();const{outcome:r}=await window.deferredPrompt.userChoice;r==="accepted"&&(window.deferredPrompt=null,n(!1))}},P=async r=>{var h,x;const I=r.currentTarget;if(r.preventDefault(),r.stopPropagation(),I.checkValidity()!==!0){i(!0);return}i(!0);const k=(h=u.current)==null?void 0:h.value,L=(x=f.current)==null?void 0:x.value;try{const s=await _({email:k,password:L});if(s.blocked)d("danger",s.message);else{const w=s==null?void 0:s.user;w?(z(s),w.type>1?t("/invoice"):t("/dashboard")):d("danger","Please provide valid email and password")}}catch{d("danger","Please provide valid email and password")}};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",style:{backgroundImage:`url(${$})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[e.jsx(U,{children:e.jsx(y,{className:"justify-content-center",children:e.jsx(c,{md:6,children:e.jsx(m,{children:e.jsx(q,{className:"p-4",children:e.jsx(A,{children:e.jsxs(B,{noValidate:!0,validated:o,onSubmit:P,children:[e.jsx("img",{src:M,style:{width:"100%",height:"auto",maxHeight:"200px"},className:"object-fit-contain"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(j,{className:"mb-3",children:[e.jsx(v,{children:e.jsx(p,{icon:D})}),e.jsx(b,{ref:u,id:"username",placeholder:"Username",autoComplete:"username",feedbackInvalid:"Please provide username.",required:!0})]}),e.jsxs(j,{className:"mb-4",children:[e.jsx(v,{children:e.jsx(p,{icon:F})}),e.jsx(b,{ref:f,id:"password",type:"password",placeholder:"Password",autoComplete:"current-password",feedbackInvalid:"Please provide password.",required:!0})]}),e.jsxs(y,{children:[e.jsx(c,{xs:6,children:e.jsx(C,{color:"primary",type:"submit",className:"px-4",children:"Login"})}),e.jsx(c,{xs:6,children:e.jsx(c,{xs:6,className:"text-right"})})]})]})})})})})})}),l&&e.jsx(C,{onClick:N,color:"success",style:{position:"fixed",top:"20px",right:"20px",borderRadius:"50%",width:"56px",height:"56px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)"},children:e.jsx(p,{icon:Z,style:{fontSize:"24px",color:"white"}})})]})};export{ae as default};
